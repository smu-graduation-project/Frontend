{"ast":null,"code":"import * as React from 'react';\nimport { debounce, ownerDocument, unstable_useEnhancedEffect as useEnhancedEffect } from '@mui/material/utils';\nimport { useGridApiEventHandler, useGridApiOptionHandler } from '../../utils/useGridApiEventHandler';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridLogger } from '../../utils/useGridLogger';\nimport { gridColumnsTotalWidthSelector } from '../columns';\nimport { gridDensityHeaderHeightSelector, gridDensityRowHeightSelector } from '../density';\nimport { useGridSelector } from '../../utils';\nimport { getVisibleRows } from '../../utils/useGridVisibleRows';\nimport { gridRowsMetaSelector } from '../rows/gridRowsMetaSelector';\nconst isTestEnvironment = process.env.NODE_ENV === 'test';\n\nconst hasScroll = _ref => {\n  let {\n    content,\n    container,\n    scrollBarSize\n  } = _ref;\n  const hasScrollXIfNoYScrollBar = content.width > container.width;\n  const hasScrollYIfNoXScrollBar = content.height > container.height;\n  let hasScrollX = false;\n  let hasScrollY = false;\n\n  if (hasScrollXIfNoYScrollBar || hasScrollYIfNoXScrollBar) {\n    hasScrollX = hasScrollXIfNoYScrollBar;\n    hasScrollY = content.height + (hasScrollX ? scrollBarSize : 0) > container.height; // We recalculate the scroll x to consider the size of the y scrollbar.\n\n    if (hasScrollY) {\n      hasScrollX = content.width + scrollBarSize > container.width;\n    }\n  }\n\n  return {\n    hasScrollX,\n    hasScrollY\n  };\n};\n\nexport function useGridDimensions(apiRef, props) {\n  const logger = useGridLogger(apiRef, 'useResizeContainer');\n  const warningShown = React.useRef(false);\n  const rootDimensionsRef = React.useRef(null);\n  const fullDimensionsRef = React.useRef(null);\n  const rowsMeta = useGridSelector(apiRef, gridRowsMetaSelector);\n  const headerHeight = useGridSelector(apiRef, gridDensityHeaderHeightSelector);\n  const updateGridDimensionsRef = React.useCallback(() => {\n    var _apiRef$current$rootE;\n\n    const rootElement = (_apiRef$current$rootE = apiRef.current.rootElementRef) == null ? void 0 : _apiRef$current$rootE.current;\n    const columnsTotalWidth = gridColumnsTotalWidthSelector(apiRef);\n\n    if (!rootDimensionsRef.current) {\n      return;\n    }\n\n    let scrollBarSize;\n\n    if (props.scrollbarSize != null) {\n      scrollBarSize = props.scrollbarSize;\n    } else if (!columnsTotalWidth || !rootElement) {\n      scrollBarSize = 0;\n    } else {\n      const doc = ownerDocument(rootElement);\n      const scrollDiv = doc.createElement('div');\n      scrollDiv.style.width = '99px';\n      scrollDiv.style.height = '99px';\n      scrollDiv.style.position = 'absolute';\n      scrollDiv.style.overflow = 'scroll';\n      scrollDiv.className = 'scrollDiv';\n      rootElement.appendChild(scrollDiv);\n      scrollBarSize = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n      rootElement.removeChild(scrollDiv);\n    }\n\n    const viewportOuterSize = {\n      width: rootDimensionsRef.current.width,\n      height: props.autoHeight ? rowsMeta.currentPageTotalHeight : rootDimensionsRef.current.height - headerHeight\n    };\n    const {\n      hasScrollX,\n      hasScrollY\n    } = hasScroll({\n      content: {\n        width: Math.round(columnsTotalWidth),\n        height: rowsMeta.currentPageTotalHeight\n      },\n      container: viewportOuterSize,\n      scrollBarSize\n    });\n    const viewportInnerSize = {\n      width: viewportOuterSize.width - (hasScrollY ? scrollBarSize : 0),\n      height: viewportOuterSize.height - (hasScrollX ? scrollBarSize : 0)\n    };\n    const newFullDimensions = {\n      viewportOuterSize,\n      viewportInnerSize,\n      hasScrollX,\n      hasScrollY\n    };\n    const prevDimensions = fullDimensionsRef.current;\n    fullDimensionsRef.current = newFullDimensions;\n\n    if (newFullDimensions.viewportInnerSize.width !== (prevDimensions == null ? void 0 : prevDimensions.viewportInnerSize.width) || newFullDimensions.viewportInnerSize.height !== (prevDimensions == null ? void 0 : prevDimensions.viewportInnerSize.height)) {\n      apiRef.current.publishEvent('viewportInnerSizeChange', newFullDimensions.viewportInnerSize);\n    }\n  }, [apiRef, props.scrollbarSize, props.autoHeight, headerHeight, rowsMeta.currentPageTotalHeight]);\n  const resize = React.useCallback(() => {\n    updateGridDimensionsRef();\n    apiRef.current.publishEvent('debouncedResize', rootDimensionsRef.current);\n  }, [apiRef, updateGridDimensionsRef]);\n  const getRootDimensions = React.useCallback(() => fullDimensionsRef.current, []);\n  const getViewportPageSize = React.useCallback(() => {\n    const dimensions = apiRef.current.getRootDimensions();\n\n    if (!dimensions) {\n      return 0;\n    }\n\n    const currentPage = getVisibleRows(apiRef, {\n      pagination: props.pagination,\n      paginationMode: props.paginationMode\n    }); // TODO: Use a combination of scrollTop, dimensions.viewportInnerSize.height and rowsMeta.possitions\n    // to find out the maximum number of rows that can fit in the visible part of the grid\n\n    if (props.getRowHeight) {\n      const renderContext = apiRef.current.unstable_getRenderContext();\n      const viewportPageSize = renderContext.lastRowIndex - renderContext.firstRowIndex;\n      return Math.min(viewportPageSize - 1, currentPage.rows.length);\n    }\n\n    const maximumPageSizeWithoutScrollBar = Math.floor(dimensions.viewportInnerSize.height / gridDensityRowHeightSelector(apiRef));\n    return Math.min(maximumPageSizeWithoutScrollBar, currentPage.rows.length);\n  }, [apiRef, props.pagination, props.paginationMode, props.getRowHeight]);\n  const dimensionsApi = {\n    resize,\n    getRootDimensions,\n    unstable_getViewportPageSize: getViewportPageSize,\n    unstable_updateGridDimensionsRef: updateGridDimensionsRef\n  };\n  useGridApiMethod(apiRef, dimensionsApi, 'GridDimensionsApi');\n  const debounceResize = React.useMemo(() => debounce(resize, 60), [resize]);\n  const isFirstSizing = React.useRef(true);\n  const handleResize = React.useCallback(size => {\n    rootDimensionsRef.current = size; // jsdom has no layout capabilities\n\n    const isJSDOM = /jsdom/.test(window.navigator.userAgent);\n\n    if (size.height === 0 && !warningShown.current && !props.autoHeight && !isJSDOM) {\n      logger.warn(['The parent of the grid has an empty height.', 'You need to make sure the container has an intrinsic height.', 'The grid displays with a height of 0px.', '', 'You can find a solution in the docs:', 'https://mui.com/x/react-data-grid/layout/'].join('\\n'));\n      warningShown.current = true;\n    }\n\n    if (size.width === 0 && !warningShown.current && !isJSDOM) {\n      logger.warn(['The parent of the grid has an empty width.', 'You need to make sure the container has an intrinsic width.', 'The grid displays with a width of 0px.', '', 'You can find a solution in the docs:', 'https://mui.com/x/react-data-grid/layout/'].join('\\n'));\n      warningShown.current = true;\n    }\n\n    if (isTestEnvironment) {\n      // We don't need to debounce the resize for tests.\n      resize();\n      isFirstSizing.current = false;\n      return;\n    }\n\n    if (isFirstSizing.current) {\n      // We want to initialize the grid dimensions as soon as possible to avoid flickering\n      resize();\n      isFirstSizing.current = false;\n      return;\n    }\n\n    debounceResize();\n  }, [props.autoHeight, debounceResize, logger, resize]);\n  useEnhancedEffect(() => updateGridDimensionsRef(), [updateGridDimensionsRef]);\n  useGridApiOptionHandler(apiRef, 'sortedRowsSet', updateGridDimensionsRef);\n  useGridApiOptionHandler(apiRef, 'pageChange', updateGridDimensionsRef);\n  useGridApiOptionHandler(apiRef, 'pageSizeChange', updateGridDimensionsRef);\n  useGridApiOptionHandler(apiRef, 'columnsChange', updateGridDimensionsRef);\n  useGridApiEventHandler(apiRef, 'resize', handleResize);\n  useGridApiOptionHandler(apiRef, 'debouncedResize', props.onResize);\n}","map":{"version":3,"sources":["C:/Users/plane/OneDrive/Desktop/git/Frontend/frontend_react/node_modules/@mui/x-data-grid/hooks/features/dimensions/useGridDimensions.js"],"names":["React","debounce","ownerDocument","unstable_useEnhancedEffect","useEnhancedEffect","useGridApiEventHandler","useGridApiOptionHandler","useGridApiMethod","useGridLogger","gridColumnsTotalWidthSelector","gridDensityHeaderHeightSelector","gridDensityRowHeightSelector","useGridSelector","getVisibleRows","gridRowsMetaSelector","isTestEnvironment","process","env","NODE_ENV","hasScroll","content","container","scrollBarSize","hasScrollXIfNoYScrollBar","width","hasScrollYIfNoXScrollBar","height","hasScrollX","hasScrollY","useGridDimensions","apiRef","props","logger","warningShown","useRef","rootDimensionsRef","fullDimensionsRef","rowsMeta","headerHeight","updateGridDimensionsRef","useCallback","_apiRef$current$rootE","rootElement","current","rootElementRef","columnsTotalWidth","scrollbarSize","doc","scrollDiv","createElement","style","position","overflow","className","appendChild","offsetWidth","clientWidth","removeChild","viewportOuterSize","autoHeight","currentPageTotalHeight","Math","round","viewportInnerSize","newFullDimensions","prevDimensions","publishEvent","resize","getRootDimensions","getViewportPageSize","dimensions","currentPage","pagination","paginationMode","getRowHeight","renderContext","unstable_getRenderContext","viewportPageSize","lastRowIndex","firstRowIndex","min","rows","length","maximumPageSizeWithoutScrollBar","floor","dimensionsApi","unstable_getViewportPageSize","unstable_updateGridDimensionsRef","debounceResize","useMemo","isFirstSizing","handleResize","size","isJSDOM","test","window","navigator","userAgent","warn","join","onResize"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { debounce, ownerDocument, unstable_useEnhancedEffect as useEnhancedEffect } from '@mui/material/utils';\r\nimport { useGridApiEventHandler, useGridApiOptionHandler } from '../../utils/useGridApiEventHandler';\r\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\r\nimport { useGridLogger } from '../../utils/useGridLogger';\r\nimport { gridColumnsTotalWidthSelector } from '../columns';\r\nimport { gridDensityHeaderHeightSelector, gridDensityRowHeightSelector } from '../density';\r\nimport { useGridSelector } from '../../utils';\r\nimport { getVisibleRows } from '../../utils/useGridVisibleRows';\r\nimport { gridRowsMetaSelector } from '../rows/gridRowsMetaSelector';\r\nconst isTestEnvironment = process.env.NODE_ENV === 'test';\r\n\r\nconst hasScroll = ({\r\n  content,\r\n  container,\r\n  scrollBarSize\r\n}) => {\r\n  const hasScrollXIfNoYScrollBar = content.width > container.width;\r\n  const hasScrollYIfNoXScrollBar = content.height > container.height;\r\n  let hasScrollX = false;\r\n  let hasScrollY = false;\r\n\r\n  if (hasScrollXIfNoYScrollBar || hasScrollYIfNoXScrollBar) {\r\n    hasScrollX = hasScrollXIfNoYScrollBar;\r\n    hasScrollY = content.height + (hasScrollX ? scrollBarSize : 0) > container.height; // We recalculate the scroll x to consider the size of the y scrollbar.\r\n\r\n    if (hasScrollY) {\r\n      hasScrollX = content.width + scrollBarSize > container.width;\r\n    }\r\n  }\r\n\r\n  return {\r\n    hasScrollX,\r\n    hasScrollY\r\n  };\r\n};\r\n\r\nexport function useGridDimensions(apiRef, props) {\r\n  const logger = useGridLogger(apiRef, 'useResizeContainer');\r\n  const warningShown = React.useRef(false);\r\n  const rootDimensionsRef = React.useRef(null);\r\n  const fullDimensionsRef = React.useRef(null);\r\n  const rowsMeta = useGridSelector(apiRef, gridRowsMetaSelector);\r\n  const headerHeight = useGridSelector(apiRef, gridDensityHeaderHeightSelector);\r\n  const updateGridDimensionsRef = React.useCallback(() => {\r\n    var _apiRef$current$rootE;\r\n\r\n    const rootElement = (_apiRef$current$rootE = apiRef.current.rootElementRef) == null ? void 0 : _apiRef$current$rootE.current;\r\n    const columnsTotalWidth = gridColumnsTotalWidthSelector(apiRef);\r\n\r\n    if (!rootDimensionsRef.current) {\r\n      return;\r\n    }\r\n\r\n    let scrollBarSize;\r\n\r\n    if (props.scrollbarSize != null) {\r\n      scrollBarSize = props.scrollbarSize;\r\n    } else if (!columnsTotalWidth || !rootElement) {\r\n      scrollBarSize = 0;\r\n    } else {\r\n      const doc = ownerDocument(rootElement);\r\n      const scrollDiv = doc.createElement('div');\r\n      scrollDiv.style.width = '99px';\r\n      scrollDiv.style.height = '99px';\r\n      scrollDiv.style.position = 'absolute';\r\n      scrollDiv.style.overflow = 'scroll';\r\n      scrollDiv.className = 'scrollDiv';\r\n      rootElement.appendChild(scrollDiv);\r\n      scrollBarSize = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n      rootElement.removeChild(scrollDiv);\r\n    }\r\n\r\n    const viewportOuterSize = {\r\n      width: rootDimensionsRef.current.width,\r\n      height: props.autoHeight ? rowsMeta.currentPageTotalHeight : rootDimensionsRef.current.height - headerHeight\r\n    };\r\n    const {\r\n      hasScrollX,\r\n      hasScrollY\r\n    } = hasScroll({\r\n      content: {\r\n        width: Math.round(columnsTotalWidth),\r\n        height: rowsMeta.currentPageTotalHeight\r\n      },\r\n      container: viewportOuterSize,\r\n      scrollBarSize\r\n    });\r\n    const viewportInnerSize = {\r\n      width: viewportOuterSize.width - (hasScrollY ? scrollBarSize : 0),\r\n      height: viewportOuterSize.height - (hasScrollX ? scrollBarSize : 0)\r\n    };\r\n    const newFullDimensions = {\r\n      viewportOuterSize,\r\n      viewportInnerSize,\r\n      hasScrollX,\r\n      hasScrollY\r\n    };\r\n    const prevDimensions = fullDimensionsRef.current;\r\n    fullDimensionsRef.current = newFullDimensions;\r\n\r\n    if (newFullDimensions.viewportInnerSize.width !== (prevDimensions == null ? void 0 : prevDimensions.viewportInnerSize.width) || newFullDimensions.viewportInnerSize.height !== (prevDimensions == null ? void 0 : prevDimensions.viewportInnerSize.height)) {\r\n      apiRef.current.publishEvent('viewportInnerSizeChange', newFullDimensions.viewportInnerSize);\r\n    }\r\n  }, [apiRef, props.scrollbarSize, props.autoHeight, headerHeight, rowsMeta.currentPageTotalHeight]);\r\n  const resize = React.useCallback(() => {\r\n    updateGridDimensionsRef();\r\n    apiRef.current.publishEvent('debouncedResize', rootDimensionsRef.current);\r\n  }, [apiRef, updateGridDimensionsRef]);\r\n  const getRootDimensions = React.useCallback(() => fullDimensionsRef.current, []);\r\n  const getViewportPageSize = React.useCallback(() => {\r\n    const dimensions = apiRef.current.getRootDimensions();\r\n\r\n    if (!dimensions) {\r\n      return 0;\r\n    }\r\n\r\n    const currentPage = getVisibleRows(apiRef, {\r\n      pagination: props.pagination,\r\n      paginationMode: props.paginationMode\r\n    }); // TODO: Use a combination of scrollTop, dimensions.viewportInnerSize.height and rowsMeta.possitions\r\n    // to find out the maximum number of rows that can fit in the visible part of the grid\r\n\r\n    if (props.getRowHeight) {\r\n      const renderContext = apiRef.current.unstable_getRenderContext();\r\n      const viewportPageSize = renderContext.lastRowIndex - renderContext.firstRowIndex;\r\n      return Math.min(viewportPageSize - 1, currentPage.rows.length);\r\n    }\r\n\r\n    const maximumPageSizeWithoutScrollBar = Math.floor(dimensions.viewportInnerSize.height / gridDensityRowHeightSelector(apiRef));\r\n    return Math.min(maximumPageSizeWithoutScrollBar, currentPage.rows.length);\r\n  }, [apiRef, props.pagination, props.paginationMode, props.getRowHeight]);\r\n  const dimensionsApi = {\r\n    resize,\r\n    getRootDimensions,\r\n    unstable_getViewportPageSize: getViewportPageSize,\r\n    unstable_updateGridDimensionsRef: updateGridDimensionsRef\r\n  };\r\n  useGridApiMethod(apiRef, dimensionsApi, 'GridDimensionsApi');\r\n  const debounceResize = React.useMemo(() => debounce(resize, 60), [resize]);\r\n  const isFirstSizing = React.useRef(true);\r\n  const handleResize = React.useCallback(size => {\r\n    rootDimensionsRef.current = size; // jsdom has no layout capabilities\r\n\r\n    const isJSDOM = /jsdom/.test(window.navigator.userAgent);\r\n\r\n    if (size.height === 0 && !warningShown.current && !props.autoHeight && !isJSDOM) {\r\n      logger.warn(['The parent of the grid has an empty height.', 'You need to make sure the container has an intrinsic height.', 'The grid displays with a height of 0px.', '', 'You can find a solution in the docs:', 'https://mui.com/x/react-data-grid/layout/'].join('\\n'));\r\n      warningShown.current = true;\r\n    }\r\n\r\n    if (size.width === 0 && !warningShown.current && !isJSDOM) {\r\n      logger.warn(['The parent of the grid has an empty width.', 'You need to make sure the container has an intrinsic width.', 'The grid displays with a width of 0px.', '', 'You can find a solution in the docs:', 'https://mui.com/x/react-data-grid/layout/'].join('\\n'));\r\n      warningShown.current = true;\r\n    }\r\n\r\n    if (isTestEnvironment) {\r\n      // We don't need to debounce the resize for tests.\r\n      resize();\r\n      isFirstSizing.current = false;\r\n      return;\r\n    }\r\n\r\n    if (isFirstSizing.current) {\r\n      // We want to initialize the grid dimensions as soon as possible to avoid flickering\r\n      resize();\r\n      isFirstSizing.current = false;\r\n      return;\r\n    }\r\n\r\n    debounceResize();\r\n  }, [props.autoHeight, debounceResize, logger, resize]);\r\n  useEnhancedEffect(() => updateGridDimensionsRef(), [updateGridDimensionsRef]);\r\n  useGridApiOptionHandler(apiRef, 'sortedRowsSet', updateGridDimensionsRef);\r\n  useGridApiOptionHandler(apiRef, 'pageChange', updateGridDimensionsRef);\r\n  useGridApiOptionHandler(apiRef, 'pageSizeChange', updateGridDimensionsRef);\r\n  useGridApiOptionHandler(apiRef, 'columnsChange', updateGridDimensionsRef);\r\n  useGridApiEventHandler(apiRef, 'resize', handleResize);\r\n  useGridApiOptionHandler(apiRef, 'debouncedResize', props.onResize);\r\n}"]},"metadata":{},"sourceType":"module"}